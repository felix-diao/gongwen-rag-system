# 公文大模型 RAG 系统

基于 FastAPI + Milvus + PostgreSQL 的企业级公文检索增强生成系统。

## 目录

- [功能特性](#功能特性)
- [系统架构](#系统架构)
- [快速开始](#快速开始)
- [API 使用指南](#api-使用指南)
- [配置说明](#配置说明)
- [部署指南](#部署指南)
- [开发指南](#开发指南)
- [常见问题](#常见问题)

## 功能特性

### 核心功能

- ✅ **多源检索**：公共文档库 + 私有文档库 + 历史会话三重检索
- ✅ **智能分块**：支持段落级智能分块，带重叠窗口
- ✅ **向量索引**：基于 Milvus 的高性能向量检索
- ✅ **权重调整**：支持文档权重和会话权重动态调整
- ✅ **重排序**：可选的 Cross-Encoder 重排序
- ✅ **流式输出**：支持 SSE 流式响应
- ✅ **会话记忆**：自动记录和检索历史会话
- ✅ **权限控制**：基于 JWT 的用户认证和授权
- ✅ **公文分类**：支持多种公文类型和标签

### 公文类型支持

- 通知
- 报告
- 请示
- 批复
- 函
- 会议纪要
- 决定
- 公告
- 通报

## 系统架构
┌─────────────────┐
│ 客户端应用 │
└────────┬────────┘
│ HTTP/SSE
▼
┌─────────────────┐
│ FastAPI 网关 │
│ - JWT 认证 │
│ - 路由分发 │
└────────┬────────┘
│
┌────┴────┬────────┬────────┐
▼ ▼ ▼ ▼
┌────────┐┌────────┐┌────────┐┌────────┐
│文档服务││RAG服务 ││会话服务││向量服务│
└───┬────┘└───┬────┘└───┬────┘└───┬────┘
│ │ │ │
▼ ▼ ▼ ▼
┌────────┐┌────────┐┌────────┐┌────────┐
│Postgres││LLM API ││Postgres││ Milvus │
└────────┘└────────┘└────────┘└────────┘


## 快速开始

### 1. 环境准备

**系统要求**
- Python 3.10+
- PostgreSQL 15+
- Milvus 2.3+
- 8GB+ RAM
- 50GB+ 磁盘空间

### 2. 安装步骤

#### 方式一：Docker Compose（推荐）

```bash
# 克隆项目
git clone <repository-url>
cd gongwen-rag-system

# 配置环境变量
cp .env.example .env
# 编辑 .env 文件，填入实际配置

# 启动所有服务
docker-compose up -d

# 查看日志
docker-compose logs -f app
```
### 3. 启动流程
 python -m uvicorn app.main:app --reload --host 127.0.0.1 --port 8000
